{"ast":null,"code":"var _jsxFileName = \"/Users/reinaka/Documents/untitled folder/_stellar_/react-burger/src/components/burger-constructor/constructor-element-block/constructor-element-block.tsx\",\n  _s = $RefreshSig$();\nimport { ConstructorElement, DragIcon } from '@ya.praktikum/react-developer-burger-ui-components';\nimport styles from './constructor-element-block.module.css';\nimport { useDrag, useDrop } from 'react-dnd';\nimport { memo } from 'react';\nimport { INGREDIENT_ITEM } from '../../../constants/constants';\nimport { REORDER_INGREDIENTS_CONSTRUCTOR } from '../../../services/actions/constructor-actions';\nimport { useDispatch } from 'react-redux';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ConstructorElementBlock = /*#__PURE__*/_s( /*#__PURE__*/memo(_c = _s(props => {\n  _s();\n  const dispatch = useDispatch();\n  let selectedName = undefined;\n  if (props.selectedBun) {\n    selectedName = `${props.ingredient.name} (${props.bun})`;\n  }\n  ;\n  const id = props.id;\n\n  //dnd элемент, который перетаскиваем\n  const [{\n    isDragging\n  }, dragReorder] = useDrag(() => {\n    return !props.draggableIngredient || !props.findIngredient ? {\n      type: INGREDIENT_ITEM\n    } : {\n      type: INGREDIENT_ITEM,\n      item: {\n        uuid: props.draggableIngredient.uuid,\n        originalIndex: props.findIngredient(props.draggableIngredient.uuid)\n      },\n      collect: monitor => ({\n        isDragging: monitor.isDragging()\n      }),\n      end: (item, monitor) => {\n        const {\n          uuid: droppedUuid,\n          originalIndex\n        } = item;\n        const didDrop = monitor.didDrop();\n        if (!didDrop) {\n          dispatch({\n            type: REORDER_INGREDIENTS_CONSTRUCTOR,\n            uuid: droppedUuid,\n            index: originalIndex\n          });\n        }\n      }\n    };\n  }, []);\n\n  //dnd элемент, на место которого перетаскиваем\n  const [, dropReorder] = useDrop(() => ({\n    accept: INGREDIENT_ITEM,\n    hover({\n      uuid: draggedId\n    }) {\n      if (props.findIngredient && props.draggableIngredient && id !== props.draggableIngredient.uuid) {\n        const overIndex = props.findIngredient(props.draggableIngredient.uuid);\n        dispatch({\n          type: REORDER_INGREDIENTS_CONSTRUCTOR,\n          uuid: draggedId,\n          index: overIndex\n        });\n      }\n    }\n  }), [props.findIngredient]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: `${styles.constructorElementBlock} ${isDragging ? styles.dragInvisible : styles.dragVisible}`,\n    draggable: true,\n    ref: node => !props.isLocked && dragReorder(dropReorder(node)),\n    children: [!props.isLocked && /*#__PURE__*/_jsxDEV(\"span\", {\n      className: \"pr-3\",\n      children: /*#__PURE__*/_jsxDEV(DragIcon, {\n        type: \"primary\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 60\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 37\n    }, this), props.isLocked && /*#__PURE__*/_jsxDEV(\"span\", {\n      className: `${styles.dragHidden} pr-3`,\n      children: /*#__PURE__*/_jsxDEV(DragIcon, {\n        type: \"primary\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 82\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 36\n    }, this), /*#__PURE__*/_jsxDEV(ConstructorElement, {\n      type: props.type === undefined ? undefined : props.type === \"top\" ? \"top\" : \"bottom\",\n      text: selectedName || props.ingredient.name,\n      price: props.ingredient.price,\n      thumbnail: props.ingredient.image,\n      isLocked: props.isLocked ? true : false,\n      handleClose: () => {\n        if (props.handleDelete && props.ingredientObject) props.handleDelete(props.ingredientObject.uuid, props.ingredientObject.ingredient.price, props.ingredientObject.ingredient);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 74,\n    columnNumber: 13\n  }, this);\n}, \"URPgI9FMQTe5ErP98rT6nDfwWjE=\", false, function () {\n  return [useDispatch, useDrag, useDrop];\n})), \"URPgI9FMQTe5ErP98rT6nDfwWjE=\", false, function () {\n  return [useDispatch, useDrag, useDrop];\n});\n_c2 = ConstructorElementBlock;\nexport default ConstructorElementBlock;\nvar _c, _c2;\n$RefreshReg$(_c, \"ConstructorElementBlock$memo\");\n$RefreshReg$(_c2, \"ConstructorElementBlock\");","map":{"version":3,"names":["ConstructorElement","DragIcon","styles","useDrag","useDrop","memo","INGREDIENT_ITEM","REORDER_INGREDIENTS_CONSTRUCTOR","useDispatch","jsxDEV","_jsxDEV","ConstructorElementBlock","_s","_c","props","dispatch","selectedName","undefined","selectedBun","ingredient","name","bun","id","isDragging","dragReorder","draggableIngredient","findIngredient","type","item","uuid","originalIndex","collect","monitor","end","droppedUuid","didDrop","index","dropReorder","accept","hover","draggedId","overIndex","className","constructorElementBlock","dragInvisible","dragVisible","draggable","ref","node","isLocked","children","fileName","_jsxFileName","lineNumber","columnNumber","dragHidden","text","price","thumbnail","image","handleClose","handleDelete","ingredientObject","_c2","$RefreshReg$"],"sources":["/Users/reinaka/Documents/untitled folder/_stellar_/react-burger/src/components/burger-constructor/constructor-element-block/constructor-element-block.tsx"],"sourcesContent":["import { ConstructorElement, DragIcon } from '@ya.praktikum/react-developer-burger-ui-components';\nimport styles from './constructor-element-block.module.css';\nimport { useDrag, useDrop } from 'react-dnd';\nimport { memo, FC } from 'react';\nimport { INGREDIENT_ITEM } from '../../../constants/constants';\nimport { REORDER_INGREDIENTS_CONSTRUCTOR } from '../../../services/actions/constructor-actions';\nimport { useDispatch } from 'react-redux';\nimport { TIngredient, TIngredientWithUUID } from '../../../services/types/types';\n\ntype TProps = {\n    selectedBun? : TIngredient,\n    ingredient : TIngredient,\n    ingredientObject? : TIngredientWithUUID,\n    id? : string,\n    draggableIngredient? : TIngredientWithUUID,\n    findIngredient? : Function,\n    handleDelete? : Function,\n    isLocked? : string,\n    bun? : string,\n    type? : string,\n};\n\nconst ConstructorElementBlock:FC<TProps> = memo(\n    (props) => {\n        const dispatch = useDispatch();\n        let selectedName = undefined;\n        if(props.selectedBun) {selectedName = `${props.ingredient.name} (${props.bun})`};\n        const id = props.id;\n\n        //dnd элемент, который перетаскиваем\n        const [{ isDragging }, dragReorder] = useDrag<{ uuid: string | undefined; originalIndex: any; }, {uuid : string, originalIndex : number}, { isDragging: boolean; }>(\n            () => {\n            return (!props.draggableIngredient || !props.findIngredient)\n            ? {type: INGREDIENT_ITEM}\n            : ({\n            type: INGREDIENT_ITEM,\n            item: { uuid: props.draggableIngredient.uuid, originalIndex: props.findIngredient(props.draggableIngredient.uuid)},\n            collect: (monitor) => ({\n                isDragging: monitor.isDragging(),\n            }),\n            end: (item, monitor) => {\n                const { uuid: droppedUuid, originalIndex } = item;\n                const didDrop = monitor.didDrop()\n                    if (!didDrop) {\n                    dispatch({\n                        type: REORDER_INGREDIENTS_CONSTRUCTOR, \n                        uuid: droppedUuid, \n                        index: originalIndex,\n                    })\n                }\n            },\n        })},[]);\n\n        //dnd элемент, на место которого перетаскиваем\n        const [, dropReorder] = useDrop<{uuid : number}>(\n            () => ({\n                accept: INGREDIENT_ITEM,\n                hover({uuid: draggedId}) {\n                if (props.findIngredient && props.draggableIngredient && id !== props.draggableIngredient.uuid) {\n                    const overIndex = props.findIngredient(props.draggableIngredient.uuid);\n                    dispatch({\n                        type: REORDER_INGREDIENTS_CONSTRUCTOR, \n                        uuid: draggedId, \n                        index: overIndex,\n                    })\n                }\n                },\n            }),\n            [props.findIngredient],\n        );\n\n        return (\n            \n            <div className={`${styles.constructorElementBlock} ${isDragging ? styles.dragInvisible :  styles.dragVisible}`} \n                draggable={true} \n                ref={(node) => !props.isLocked && dragReorder(dropReorder(node))}\n            > \n                {!props.isLocked && <span className=\"pr-3\"><DragIcon type=\"primary\"/></span>}\n                {props.isLocked && <span className={`${styles.dragHidden} pr-3`}><DragIcon type=\"primary\"/></span>}\n                <ConstructorElement \n                    type={props.type === undefined ? undefined : props.type === \"top\" ? \"top\" : \"bottom\"}\n                    text={selectedName || props.ingredient.name}\n                    price={props.ingredient.price}\n                    thumbnail={props.ingredient.image}\n                    isLocked={props.isLocked ? true : false} \n                    handleClose={() => {\n                        if(props.handleDelete && props.ingredientObject) props.handleDelete(\n                                                        props.ingredientObject.uuid, \n                                                        props.ingredientObject.ingredient.price, \n                                                        props.ingredientObject.ingredient)\n                    }}\n                />\n            </div>\n        )\n    })\n\nexport default ConstructorElementBlock;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}