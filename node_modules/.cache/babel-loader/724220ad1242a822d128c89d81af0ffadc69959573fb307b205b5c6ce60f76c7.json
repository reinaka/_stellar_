{"ast":null,"code":"export const socketMiddleware = wsActions => {\n  return store => {\n    let socket = null;\n    return next => action => {\n      const {\n        dispatch\n      } = store;\n      const {\n        type,\n        payload\n      } = action;\n      const {\n        wsInit,\n        onOpen,\n        onClosed,\n        onError,\n        onMessage,\n        onSendMessage\n      } = wsActions;\n      if (type === wsInit) {\n        socket = new WebSocket(`${action.baseUrl}${payload}`);\n      }\n      ;\n      if (socket) {\n        socket.onopen = event => {\n          dispatch({\n            type: onOpen,\n            payload: event\n          });\n        };\n        socket.onerror = event => {\n          dispatch({\n            type: onError,\n            payload: event\n          });\n        };\n        socket.onmessage = event => {\n          const {\n            data\n          } = JSON.parse(event);\n          dispatch({\n            type: onMessage\n          });\n        };\n        socket.onclose = event => {\n          dispatch({\n            type: onClosed,\n            payload: event\n          });\n        };\n        if (type === onSendMessage) {\n          const message = action.payload;\n          socket.send(JSON.stringify(message));\n        }\n      }\n      next(action);\n    };\n  };\n};","map":{"version":3,"names":["socketMiddleware","wsActions","store","socket","next","action","dispatch","type","payload","wsInit","onOpen","onClosed","onError","onMessage","onSendMessage","WebSocket","baseUrl","onopen","event","onerror","onmessage","data","JSON","parse","onclose","message","send","stringify"],"sources":["/Users/reinaka/Documents/untitled folder/_stellar_/react-burger/src/services/middleware/socketMiddleware.ts"],"sourcesContent":["import type { Middleware, MiddlewareAPI } from 'redux';\nimport { AppDispatch } from '../types/thunkTypes';\nimport { RootState } from '../types/thunkTypes';\nimport { TWSActions, TSocketActions } from '../actions/socket-actions';\n\nexport const socketMiddleware = (wsActions: TWSActions): Middleware => {\n    return ((store: MiddlewareAPI<AppDispatch, RootState>) => {\n        let socket: WebSocket | null = null;\n\n    return next => (action: TSocketActions) => {\n        const { dispatch } = store;\n        const { type, payload } = action;\n        const { wsInit, onOpen, onClosed, onError, onMessage, onSendMessage } = wsActions;\n\n        if (type === wsInit) {\n            socket = new WebSocket(`${action.baseUrl}${payload}`);\n        };\n\n        if (socket) {\n        socket.onopen = event => {\n            dispatch({ type: onOpen, payload: event });\n        };\n\n        socket.onerror = event => {\n            dispatch({ type: onError, payload: event });\n        };\n\n        socket.onmessage = event => {\n            const { data } = JSON.parse(event);\n            dispatch({ \n                type: onMessage,\n             });\n        };\n        \n        socket.onclose = event => {\n            dispatch({ type: onClosed, payload: event });\n        };\n\n        if (type === onSendMessage) {\n            const message  = action.payload;\n            socket.send(JSON.stringify(message));\n        }\n    }\n\n    next(action);\n    };\n    }) as Middleware;\n}; "],"mappings":"AAKA,OAAO,MAAMA,gBAAgB,GAAIC,SAAqB,IAAiB;EACnE,OAASC,KAA4C,IAAK;IACtD,IAAIC,MAAwB,GAAG,IAAI;IAEvC,OAAOC,IAAI,IAAKC,MAAsB,IAAK;MACvC,MAAM;QAAEC;MAAS,CAAC,GAAGJ,KAAK;MAC1B,MAAM;QAAEK,IAAI;QAAEC;MAAQ,CAAC,GAAGH,MAAM;MAChC,MAAM;QAAEI,MAAM;QAAEC,MAAM;QAAEC,QAAQ;QAAEC,OAAO;QAAEC,SAAS;QAAEC;MAAc,CAAC,GAAGb,SAAS;MAEjF,IAAIM,IAAI,KAAKE,MAAM,EAAE;QACjBN,MAAM,GAAG,IAAIY,SAAS,CAAE,GAAEV,MAAM,CAACW,OAAQ,GAAER,OAAQ,EAAC,CAAC;MACzD;MAAC;MAED,IAAIL,MAAM,EAAE;QACZA,MAAM,CAACc,MAAM,GAAGC,KAAK,IAAI;UACrBZ,QAAQ,CAAC;YAAEC,IAAI,EAAEG,MAAM;YAAEF,OAAO,EAAEU;UAAM,CAAC,CAAC;QAC9C,CAAC;QAEDf,MAAM,CAACgB,OAAO,GAAGD,KAAK,IAAI;UACtBZ,QAAQ,CAAC;YAAEC,IAAI,EAAEK,OAAO;YAAEJ,OAAO,EAAEU;UAAM,CAAC,CAAC;QAC/C,CAAC;QAEDf,MAAM,CAACiB,SAAS,GAAGF,KAAK,IAAI;UACxB,MAAM;YAAEG;UAAK,CAAC,GAAGC,IAAI,CAACC,KAAK,CAACL,KAAK,CAAC;UAClCZ,QAAQ,CAAC;YACLC,IAAI,EAAEM;UACT,CAAC,CAAC;QACP,CAAC;QAEDV,MAAM,CAACqB,OAAO,GAAGN,KAAK,IAAI;UACtBZ,QAAQ,CAAC;YAAEC,IAAI,EAAEI,QAAQ;YAAEH,OAAO,EAAEU;UAAM,CAAC,CAAC;QAChD,CAAC;QAED,IAAIX,IAAI,KAAKO,aAAa,EAAE;UACxB,MAAMW,OAAO,GAAIpB,MAAM,CAACG,OAAO;UAC/BL,MAAM,CAACuB,IAAI,CAACJ,IAAI,CAACK,SAAS,CAACF,OAAO,CAAC,CAAC;QACxC;MACJ;MAEArB,IAAI,CAACC,MAAM,CAAC;IACZ,CAAC;EACD,CAAC;AACL,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}