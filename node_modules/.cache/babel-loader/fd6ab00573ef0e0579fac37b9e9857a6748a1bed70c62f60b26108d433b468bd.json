{"ast":null,"code":"var _jsxFileName = \"/Users/reinaka/Documents/untitled folder/_stellar_/react-burger/src/components/burger-constructor/constructor-element-block/constructor-element-block.tsx\",\n  _s = $RefreshSig$();\nimport { ConstructorElement, DragIcon } from '@ya.praktikum/react-developer-burger-ui-components';\nimport styles from './constructor-element-block.module.css';\nimport { useDrag, useDrop } from 'react-dnd';\nimport { memo } from 'react';\nimport { INGREDIENT_ITEM } from '../../../constants/constants';\nimport { REORDER_INGREDIENTS_CONSTRUCTOR } from '../../../services/actions/constructor-actions';\nimport { useDispatch } from 'react-redux';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ConstructorElementBlock = /*#__PURE__*/_s( /*#__PURE__*/memo(_c = _s(props => {\n  _s();\n  const dispatch = useDispatch();\n  let selectedName = undefined;\n  if (props.bun) {\n    selectedName = `${props.ingredient.name} (${props.bun})`;\n  }\n  ;\n  const id = props.id;\n\n  //dnd элемент, который перетаскиваем\n  const [{\n    isDragging\n  }, dragReorder] = useDrag(() => {\n    return !props.draggableIngredient || !props.findIngredient ? {\n      type: INGREDIENT_ITEM\n    } : {\n      type: INGREDIENT_ITEM,\n      item: {\n        uuid: props.draggableIngredient.uuid,\n        originalIndex: props.findIngredient(props.draggableIngredient.uuid)\n      },\n      collect: monitor => ({\n        isDragging: monitor.isDragging()\n      }),\n      end: (item, monitor) => {\n        const {\n          uuid: droppedUuid,\n          originalIndex\n        } = item;\n        const didDrop = monitor.didDrop();\n        if (!didDrop) {\n          dispatch({\n            type: REORDER_INGREDIENTS_CONSTRUCTOR,\n            uuid: droppedUuid,\n            index: originalIndex\n          });\n        }\n      }\n    };\n  }, []);\n\n  //dnd элемент, на место которого перетаскиваем\n  const [, dropReorder] = useDrop(() => ({\n    accept: INGREDIENT_ITEM,\n    hover({\n      uuid: draggedId\n    }) {\n      if (props.findIngredient && props.draggableIngredient && id !== props.draggableIngredient.uuid) {\n        const overIndex = props.findIngredient(props.draggableIngredient.uuid);\n        dispatch({\n          type: REORDER_INGREDIENTS_CONSTRUCTOR,\n          uuid: draggedId,\n          index: overIndex\n        });\n      }\n    }\n  }), [props.findIngredient]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: `${styles.constructorElementBlock} ${isDragging ? styles.dragInvisible : styles.dragVisible}`,\n    draggable: true,\n    ref: node => !props.isLocked && dragReorder(dropReorder(node)),\n    children: [!props.isLocked && /*#__PURE__*/_jsxDEV(\"span\", {\n      className: \"pr-3\",\n      children: /*#__PURE__*/_jsxDEV(DragIcon, {\n        type: \"primary\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 60\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 37\n    }, this), props.isLocked && /*#__PURE__*/_jsxDEV(\"span\", {\n      className: `${styles.dragHidden} pr-3`,\n      children: /*#__PURE__*/_jsxDEV(DragIcon, {\n        type: \"primary\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 82\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 36\n    }, this), /*#__PURE__*/_jsxDEV(ConstructorElement, {\n      type: props.type === undefined ? undefined : props.type === \"top\" ? \"top\" : \"bottom\",\n      text: selectedName || props.ingredient.name,\n      price: props.ingredient.price,\n      thumbnail: props.ingredient.image,\n      isLocked: props.isLocked ? true : false,\n      handleClose: () => {\n        if (props.handleDelete && props.ingredientObject) props.handleDelete(props.ingredientObject.uuid, props.ingredientObject.ingredient.price, props.ingredientObject.ingredient);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 73,\n    columnNumber: 13\n  }, this);\n}, \"URPgI9FMQTe5ErP98rT6nDfwWjE=\", false, function () {\n  return [useDispatch, useDrag, useDrop];\n})), \"URPgI9FMQTe5ErP98rT6nDfwWjE=\", false, function () {\n  return [useDispatch, useDrag, useDrop];\n});\n_c2 = ConstructorElementBlock;\nexport default ConstructorElementBlock;\nvar _c, _c2;\n$RefreshReg$(_c, \"ConstructorElementBlock$memo\");\n$RefreshReg$(_c2, \"ConstructorElementBlock\");","map":{"version":3,"names":["ConstructorElement","DragIcon","styles","useDrag","useDrop","memo","INGREDIENT_ITEM","REORDER_INGREDIENTS_CONSTRUCTOR","useDispatch","jsxDEV","_jsxDEV","ConstructorElementBlock","_s","_c","props","dispatch","selectedName","undefined","bun","ingredient","name","id","isDragging","dragReorder","draggableIngredient","findIngredient","type","item","uuid","originalIndex","collect","monitor","end","droppedUuid","didDrop","index","dropReorder","accept","hover","draggedId","overIndex","className","constructorElementBlock","dragInvisible","dragVisible","draggable","ref","node","isLocked","children","fileName","_jsxFileName","lineNumber","columnNumber","dragHidden","text","price","thumbnail","image","handleClose","handleDelete","ingredientObject","_c2","$RefreshReg$"],"sources":["/Users/reinaka/Documents/untitled folder/_stellar_/react-burger/src/components/burger-constructor/constructor-element-block/constructor-element-block.tsx"],"sourcesContent":["import { ConstructorElement, DragIcon } from '@ya.praktikum/react-developer-burger-ui-components';\nimport styles from './constructor-element-block.module.css';\nimport { useDrag, useDrop } from 'react-dnd';\nimport { memo, FC } from 'react';\nimport { INGREDIENT_ITEM } from '../../../constants/constants';\nimport { REORDER_INGREDIENTS_CONSTRUCTOR } from '../../../services/actions/constructor-actions';\nimport { useDispatch } from 'react-redux';\nimport { TIngredient, TIngredientWithUUID } from '../../../services/types/types';\n\ntype TProps = {\n    selectedBun? : TIngredient,\n    ingredient : TIngredient,\n    ingredientObject? : TIngredientWithUUID,\n    id? : string,\n    draggableIngredient? : TIngredientWithUUID,\n    findIngredient? : Function,\n    handleDelete? : Function,\n    isLocked? : string,\n    bun? : string,\n    type? : string,\n};\n\nconst ConstructorElementBlock:FC<TProps> = memo(\n    (props) => {\n        const dispatch = useDispatch();\n        let selectedName = undefined;\n        if(props.bun) {selectedName = `${props.ingredient.name} (${props.bun})`};\n        const id = props.id;\n\n        //dnd элемент, который перетаскиваем\n        const [{ isDragging }, dragReorder] = useDrag<{ uuid: string | undefined; originalIndex: any; }, {uuid : string, originalIndex : number}, { isDragging: boolean; }>(\n            () => {\n            return (!props.draggableIngredient || !props.findIngredient)\n            ? {type: INGREDIENT_ITEM}\n            : ({\n            type: INGREDIENT_ITEM,\n            item: { uuid: props.draggableIngredient.uuid, originalIndex: props.findIngredient(props.draggableIngredient.uuid)},\n            collect: (monitor) => ({\n                isDragging: monitor.isDragging(),\n            }),\n            end: (item, monitor) => {\n                const { uuid: droppedUuid, originalIndex } = item;\n                const didDrop = monitor.didDrop()\n                    if (!didDrop) {\n                    dispatch({\n                        type: REORDER_INGREDIENTS_CONSTRUCTOR, \n                        uuid: droppedUuid, \n                        index: originalIndex,\n                    })\n                }\n            },\n        })},[]);\n\n        //dnd элемент, на место которого перетаскиваем\n        const [, dropReorder] = useDrop<{uuid : number}>(\n            () => ({\n                accept: INGREDIENT_ITEM,\n                hover({uuid: draggedId}) {\n                if (props.findIngredient && props.draggableIngredient && id !== props.draggableIngredient.uuid) {\n                    const overIndex = props.findIngredient(props.draggableIngredient.uuid);\n                    dispatch({\n                        type: REORDER_INGREDIENTS_CONSTRUCTOR, \n                        uuid: draggedId, \n                        index: overIndex,\n                    })\n                }\n                },\n            }),\n            [props.findIngredient],\n        );\n\n        return (\n            <div className={`${styles.constructorElementBlock} ${isDragging ? styles.dragInvisible :  styles.dragVisible}`} \n                draggable={true} \n                ref={(node) => !props.isLocked && dragReorder(dropReorder(node))}\n            > \n                {!props.isLocked && <span className=\"pr-3\"><DragIcon type=\"primary\"/></span>}\n                {props.isLocked && <span className={`${styles.dragHidden} pr-3`}><DragIcon type=\"primary\"/></span>}\n                <ConstructorElement \n                    type={props.type === undefined ? undefined : props.type === \"top\" ? \"top\" : \"bottom\"}\n                    text={selectedName || props.ingredient.name}\n                    price={props.ingredient.price}\n                    thumbnail={props.ingredient.image}\n                    isLocked={props.isLocked ? true : false} \n                    handleClose={() => {\n                        if(props.handleDelete && props.ingredientObject) props.handleDelete(\n                                                        props.ingredientObject.uuid, \n                                                        props.ingredientObject.ingredient.price, \n                                                        props.ingredientObject.ingredient)\n                    }}\n                />\n            </div>\n        )\n    })\n\nexport default ConstructorElementBlock;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}