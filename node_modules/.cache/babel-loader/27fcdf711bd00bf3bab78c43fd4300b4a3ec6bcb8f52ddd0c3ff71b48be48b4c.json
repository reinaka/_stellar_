{"ast":null,"code":"var _jsxFileName = \"/Users/reinaka/Documents/untitled folder/_stellar_/react-burger/src/pages/login-page/login-page.tsx\",\n  _s = $RefreshSig$();\nimport { EmailInput, PasswordInput, Button } from '@ya.praktikum/react-developer-burger-ui-components';\nimport { RegistrationWrapper } from '../../components/ui-elements/form-registration-wrapper/form-registration-wrapper';\nimport { getAuth } from '../../services/actions/auth-actions';\nimport { selectLoginSuccess, selectAuthError } from '../../services/functions/selectorFunctions';\nimport { useCallback, useEffect, useState } from 'react';\nimport { Navigate } from 'react-router-dom';\nimport ErrorModal from '../../components/modal/error-modal/error-modal';\nimport { useModal } from '../../services/hooks/use-modal';\nimport { useLocation } from 'react-router-dom';\nimport { BASE_URL, AUTH_ENDPOINT } from '../../constants/constants';\nimport RegistrationForm from '../../components/ui-elements/form-registration/form-registration';\nimport RegisterFormText from '../../components/ui-elements/register-form-text/register-form-text';\nimport { useFormAndValidation } from '../../services/hooks/use-form-validation';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport function LoginPage() {\n  _s();\n  var _location$state, _location$state$locat;\n  const dispatch = useDispatch();\n  const loggedIn = useSelector(selectLoginSuccess);\n  const authError = useSelector(selectAuthError);\n  const location = useLocation();\n  const [errorText, setErrorText] = useState(\"\");\n  const [isModalVisible, openModal, closeModal] = useModal();\n  const {\n    values,\n    handleChange\n  } = useFormAndValidation({\n    email: \"\",\n    password: \"\"\n  });\n  useEffect(() => {\n    if (authError) {\n      if (authError === \"email or password are incorrect\") {\n        setErrorText(\"Неверный логин или пароль\");\n        openModal();\n      }\n    }\n  }, [authError, openModal]);\n  const dataToPost = {\n    \"email\": values.email,\n    \"password\": values.password\n  };\n  const handleLogin = useCallback(data => {\n    dispatch(getAuth(AUTH_ENDPOINT, data));\n  }, [dispatch]);\n  return loggedIn ? /*#__PURE__*/_jsxDEV(Navigate, {\n    to: (location === null || location === void 0 ? void 0 : (_location$state = location.state) === null || _location$state === void 0 ? void 0 : (_location$state$locat = _location$state.location) === null || _location$state$locat === void 0 ? void 0 : _location$state$locat.pathname) || \"/\",\n    replace: true,\n    state: {\n      location\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 52,\n    columnNumber: 7\n  }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(RegistrationWrapper, {\n      children: [/*#__PURE__*/_jsxDEV(RegistrationForm, {\n        title: \"\\u0412\\u0445\\u043E\\u0434\",\n        buttonText: \"\\u0412\\u043E\\u0439\\u0442\\u0438\",\n        onSubmit: e => {\n          e.preventDefault();\n          handleLogin(dataToPost);\n        },\n        action: `${BASE_URL}${AUTH_ENDPOINT}`,\n        method: \"POST\",\n        children: [/*#__PURE__*/_jsxDEV(EmailInput, {\n          extraClass: \"mb-6\",\n          value: values.email || \"\",\n          name: 'email',\n          onChange: e => handleChange(e)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(PasswordInput, {\n          value: values.password || \"\",\n          name: \"password\",\n          onChange: e => handleChange(e)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          extraClass: \"mb-20 mt-6\",\n          htmlType: \"submit\",\n          children: \"\\u0412\\u043E\\u0439\\u0442\\u0438\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(RegisterFormText, {\n        linkText: \"\\u0417\\u0430\\u0440\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\\u0441\\u044F\",\n        linkAddress: \"/register\",\n        children: \"\\u0412\\u044B \\u2014 \\u043D\\u043E\\u0432\\u044B\\u0439 \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044C?\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(RegisterFormText, {\n        linkText: \"\\u0412\\u043E\\u0441\\u0441\\u0442\\u0430\\u043D\\u043E\\u0432\\u0438\\u0442\\u044C \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C\",\n        linkAddress: \"/forgot-password\",\n        children: \"\\u0417\\u0430\\u0431\\u044B\\u043B\\u0438 \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C?\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 9\n    }, this), authError && isModalVisible && /*#__PURE__*/_jsxDEV(ErrorModal, {\n      message: errorText,\n      closeModal: closeModal\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 41\n    }, this)]\n  }, void 0, true);\n}\n_s(LoginPage, \"zQSS48K+TSN0sT7QHZLRsHoHtG0=\", true, function () {\n  return [useLocation, useModal, useFormAndValidation];\n});\n_c = LoginPage;\nvar _c;\n$RefreshReg$(_c, \"LoginPage\");","map":{"version":3,"names":["EmailInput","PasswordInput","Button","RegistrationWrapper","getAuth","selectLoginSuccess","selectAuthError","useCallback","useEffect","useState","Navigate","ErrorModal","useModal","useLocation","BASE_URL","AUTH_ENDPOINT","RegistrationForm","RegisterFormText","useFormAndValidation","jsxDEV","_jsxDEV","Fragment","_Fragment","LoginPage","_s","_location$state","_location$state$locat","dispatch","useDispatch","loggedIn","useSelector","authError","location","errorText","setErrorText","isModalVisible","openModal","closeModal","values","handleChange","email","password","dataToPost","handleLogin","data","to","state","pathname","replace","fileName","_jsxFileName","lineNumber","columnNumber","children","title","buttonText","onSubmit","e","preventDefault","action","method","extraClass","value","name","onChange","htmlType","linkText","linkAddress","message","_c","$RefreshReg$"],"sources":["/Users/reinaka/Documents/untitled folder/_stellar_/react-burger/src/pages/login-page/login-page.tsx"],"sourcesContent":["import { EmailInput, PasswordInput, Button } from '@ya.praktikum/react-developer-burger-ui-components' ;\nimport { RegistrationWrapper } from '../../components/ui-elements/form-registration-wrapper/form-registration-wrapper';\nimport { getAuth } from '../../services/actions/auth-actions';\nimport { useAppSelector } from '../../services/hooks/reduxTypes';\nimport { selectLoginSuccess, selectAuthError } from '../../services/functions/selectorFunctions';\nimport { useCallback, useEffect, useState } from 'react';\nimport { Navigate } from 'react-router-dom';\nimport ErrorModal from '../../components/modal/error-modal/error-modal';\nimport { useModal } from '../../services/hooks/use-modal';\nimport { useLocation } from 'react-router-dom';\nimport { BASE_URL, AUTH_ENDPOINT } from '../../constants/constants';\nimport RegistrationForm from '../../components/ui-elements/form-registration/form-registration';\nimport RegisterFormText from '../../components/ui-elements/register-form-text/register-form-text';\nimport { useFormAndValidation } from '../../services/hooks/use-form-validation';\n\ntype FormStateType = {\n    email : string,\n    password : string,\n};\n\nexport function LoginPage () {\n    const dispatch = useDispatch() as any;\n    const loggedIn = useSelector(selectLoginSuccess);\n    const authError = useSelector(selectAuthError);\n    const location = useLocation();\n    const [errorText, setErrorText] = useState(\"\");\n    const [isModalVisible, openModal, closeModal] = useModal();\n    const {values, handleChange} = useFormAndValidation<FormStateType>({\n        email : \"\",\n        password : \"\",\n    });\n\n    useEffect(() => {\n        if(authError) {\n            if(authError === \"email or password are incorrect\") {\n                setErrorText(\"Неверный логин или пароль\");\n                openModal();\n            }\n    }}, [authError, openModal]);\n\n    const dataToPost = {\n        \"email\": values.email,\n        \"password\": values.password,\n    }\n\n    const handleLogin = useCallback(\n        (data : {email : string, password : string}) => {\n            dispatch(getAuth(AUTH_ENDPOINT, data));\n    },[dispatch]);\n\n    return loggedIn\n    ? <Navigate to={location?.state?.location?.pathname || \"/\"} replace state={{location}}/>\n    : (\n        <>\n        <RegistrationWrapper>\n            <RegistrationForm \n                title=\"Вход\" \n                buttonText=\"Войти\" \n                onSubmit={(e: { preventDefault: () => void; }) => {e.preventDefault(); handleLogin(dataToPost)}}\n                action={`${BASE_URL}${AUTH_ENDPOINT}`}\n                method=\"POST\"\n            >\n                <EmailInput \n                    extraClass=\"mb-6\" \n                    value={values.email || \"\"} \n                    name={'email'} \n                    onChange={(e) => handleChange(e)}\n                />\n                <PasswordInput \n                    value={values.password || \"\"} \n                    name=\"password\" \n                    onChange={(e) => handleChange(e)}\n                />\n                <Button \n                    extraClass=\"mb-20 mt-6\" \n                    htmlType=\"submit\" \n                >Войти</Button>\n            </RegistrationForm>\n            <RegisterFormText linkText=\"Зарегистрироваться\" linkAddress=\"/register\">Вы — новый пользователь?</RegisterFormText>\n            <RegisterFormText linkText=\"Восстановить пароль\" linkAddress=\"/forgot-password\">Забыли пароль?</RegisterFormText>\n        </RegistrationWrapper>\n        {authError && isModalVisible && <ErrorModal message={errorText} closeModal={closeModal}/>}\n        </>\n    )\n}\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}