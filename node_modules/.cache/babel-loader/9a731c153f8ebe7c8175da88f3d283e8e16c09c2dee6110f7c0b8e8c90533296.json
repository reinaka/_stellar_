{"ast":null,"code":"import { ADD_INGREDIENT_CONSTRUCTOR, DELETE_INGREDIENT_CONSTRUCTOR, ADD_BUN_CONSTRUCTOR, REORDER_INGREDIENTS_CONSTRUCTOR, CLEAR_CONSTRUCTOR } from '../actions/constructor-actions';\nexport const initialState = {\n  selectedBun: null,\n  items: [],\n  totalCost: 0\n};\nexport const constructorIngredientsReducer = (state = initialState, action) => {\n  switch (action.type) {\n    case ADD_INGREDIENT_CONSTRUCTOR:\n      {\n        const ingredient = {\n          ingredient: action.payload,\n          uuid: action.uuid\n        };\n        return {\n          ...state,\n          items: [...state.items, ingredient],\n          totalCost: state.totalCost + ingredient.ingredient.price\n        };\n      }\n    case ADD_BUN_CONSTRUCTOR:\n      {\n        if (state.selectedBun && action.payload._id === state.selectedBun._id) return state;\n        return {\n          ...state,\n          selectedBun: action.payload,\n          totalCost: state.selectedBun ? state.totalCost - state.selectedBun.price * 2 + action.payload.price * 2 : state.totalCost + action.payload.price * 2\n        };\n      }\n    case DELETE_INGREDIENT_CONSTRUCTOR:\n      {\n        return {\n          ...state,\n          items: action.payload,\n          totalCost: state.totalCost - action.price\n        };\n      }\n    case REORDER_INGREDIENTS_CONSTRUCTOR:\n      {\n        let newOrderList = state.items.slice();\n        const originalIndex = state.items.findIndex(item => item.uuid === action.uuid);\n        const draggableItem = state.items[originalIndex];\n        newOrderList.splice(originalIndex, 1);\n        newOrderList.splice(action.index, 0, draggableItem);\n        return {\n          ...state,\n          items: newOrderList\n        };\n      }\n    case CLEAR_CONSTRUCTOR:\n      {\n        return initialState;\n      }\n    default:\n      {\n        return state;\n      }\n  }\n};","map":{"version":3,"names":["ADD_INGREDIENT_CONSTRUCTOR","DELETE_INGREDIENT_CONSTRUCTOR","ADD_BUN_CONSTRUCTOR","REORDER_INGREDIENTS_CONSTRUCTOR","CLEAR_CONSTRUCTOR","initialState","selectedBun","items","totalCost","constructorIngredientsReducer","state","action","type","ingredient","payload","uuid","price","_id","newOrderList","slice","originalIndex","findIndex","item","draggableItem","splice","index"],"sources":["/Users/reinaka/Documents/untitled folder/_stellar_/react-burger/src/services/reducers/constructor-ingredients-reducer.ts"],"sourcesContent":["import { \n        ADD_INGREDIENT_CONSTRUCTOR, \n        DELETE_INGREDIENT_CONSTRUCTOR, \n        ADD_BUN_CONSTRUCTOR,\n        REORDER_INGREDIENTS_CONSTRUCTOR,\n        CLEAR_CONSTRUCTOR\n    } from '../actions/constructor-actions';\nimport { TIngredient, TIngredientWithUUID } from '../types/types';\nimport { TConstructorActions } from '../actions/constructor-actions';\n\ntype TState = {\n    selectedBun: null | TIngredient,\n    items: TIngredientWithUUID[] | [],\n    totalCost: number,\n};\n\nexport const initialState : TState = {\n    selectedBun: null,\n    items: [],\n    totalCost: 0,\n};\n\nexport const constructorIngredientsReducer = (state=initialState, action : TConstructorActions) : TState => {\n    switch(action.type) {\n        case ADD_INGREDIENT_CONSTRUCTOR: {\n            const ingredient = {\n                ingredient: action.payload,\n                uuid: action.uuid,\n            }\n            return {\n                ...state,\n                items: [...state.items, ingredient],\n                totalCost: state.totalCost + ingredient.ingredient.price,\n            }\n        }\n        case ADD_BUN_CONSTRUCTOR: {\n            if(state.selectedBun && action.payload._id === state.selectedBun._id) return state;\n            return {\n                ...state,\n                selectedBun: action.payload,\n                totalCost: state.selectedBun \n                            ? (state.totalCost - state.selectedBun.price * 2 + action.payload.price * 2) \n                            : state.totalCost + action.payload.price * 2,\n            }\n        }\n        case DELETE_INGREDIENT_CONSTRUCTOR: {\n            return {\n                ...state,\n                items: action.payload,\n                totalCost: state.totalCost - action.price,\n            }\n        }\n        case REORDER_INGREDIENTS_CONSTRUCTOR: {\n            let newOrderList = state.items.slice();\n            const originalIndex = state.items.findIndex(item => item.uuid === action.uuid);\n            const draggableItem = state.items[originalIndex];\n\n            newOrderList.splice(originalIndex, 1);\n            newOrderList.splice(action.index, 0, draggableItem);\n            return {\n                ...state,\n                items: newOrderList,\n            }\n        }\n        case CLEAR_CONSTRUCTOR: {\n            return initialState;\n        }\n        default: {\n            return state;\n        }\n}}"],"mappings":"AAAA,SACQA,0BAA0B,EAC1BC,6BAA6B,EAC7BC,mBAAmB,EACnBC,+BAA+B,EAC/BC,iBAAiB,QACd,gCAAgC;AAU3C,OAAO,MAAMC,YAAqB,GAAG;EACjCC,WAAW,EAAE,IAAI;EACjBC,KAAK,EAAE,EAAE;EACTC,SAAS,EAAE;AACf,CAAC;AAED,OAAO,MAAMC,6BAA6B,GAAGA,CAACC,KAAK,GAACL,YAAY,EAAEM,MAA4B,KAAc;EACxG,QAAOA,MAAM,CAACC,IAAI;IACd,KAAKZ,0BAA0B;MAAE;QAC7B,MAAMa,UAAU,GAAG;UACfA,UAAU,EAAEF,MAAM,CAACG,OAAO;UAC1BC,IAAI,EAAEJ,MAAM,CAACI;QACjB,CAAC;QACD,OAAO;UACH,GAAGL,KAAK;UACRH,KAAK,EAAE,CAAC,GAAGG,KAAK,CAACH,KAAK,EAAEM,UAAU,CAAC;UACnCL,SAAS,EAAEE,KAAK,CAACF,SAAS,GAAGK,UAAU,CAACA,UAAU,CAACG;QACvD,CAAC;MACL;IACA,KAAKd,mBAAmB;MAAE;QACtB,IAAGQ,KAAK,CAACJ,WAAW,IAAIK,MAAM,CAACG,OAAO,CAACG,GAAG,KAAKP,KAAK,CAACJ,WAAW,CAACW,GAAG,EAAE,OAAOP,KAAK;QAClF,OAAO;UACH,GAAGA,KAAK;UACRJ,WAAW,EAAEK,MAAM,CAACG,OAAO;UAC3BN,SAAS,EAAEE,KAAK,CAACJ,WAAW,GACbI,KAAK,CAACF,SAAS,GAAGE,KAAK,CAACJ,WAAW,CAACU,KAAK,GAAG,CAAC,GAAGL,MAAM,CAACG,OAAO,CAACE,KAAK,GAAG,CAAC,GACzEN,KAAK,CAACF,SAAS,GAAGG,MAAM,CAACG,OAAO,CAACE,KAAK,GAAG;QAC3D,CAAC;MACL;IACA,KAAKf,6BAA6B;MAAE;QAChC,OAAO;UACH,GAAGS,KAAK;UACRH,KAAK,EAAEI,MAAM,CAACG,OAAO;UACrBN,SAAS,EAAEE,KAAK,CAACF,SAAS,GAAGG,MAAM,CAACK;QACxC,CAAC;MACL;IACA,KAAKb,+BAA+B;MAAE;QAClC,IAAIe,YAAY,GAAGR,KAAK,CAACH,KAAK,CAACY,KAAK,CAAC,CAAC;QACtC,MAAMC,aAAa,GAAGV,KAAK,CAACH,KAAK,CAACc,SAAS,CAACC,IAAI,IAAIA,IAAI,CAACP,IAAI,KAAKJ,MAAM,CAACI,IAAI,CAAC;QAC9E,MAAMQ,aAAa,GAAGb,KAAK,CAACH,KAAK,CAACa,aAAa,CAAC;QAEhDF,YAAY,CAACM,MAAM,CAACJ,aAAa,EAAE,CAAC,CAAC;QACrCF,YAAY,CAACM,MAAM,CAACb,MAAM,CAACc,KAAK,EAAE,CAAC,EAAEF,aAAa,CAAC;QACnD,OAAO;UACH,GAAGb,KAAK;UACRH,KAAK,EAAEW;QACX,CAAC;MACL;IACA,KAAKd,iBAAiB;MAAE;QACpB,OAAOC,YAAY;MACvB;IACA;MAAS;QACL,OAAOK,KAAK;MAChB;EACR;AAAC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}